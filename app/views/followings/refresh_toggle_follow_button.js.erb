$(document).ready(function(){
  var app = new App();

  // toggle follow button on followings index
  $toggle_follow_button = $("<%= j toggle_follow_button @following.user, @following.followed %>");
  app.refresh_content($('<%= "#js-followings-user-#{@following.followed.id}" %>').find('.js-toggle-follow'), $toggle_follow_button);

  // manage sidebar followed users
  <% if @following.persisted? %>
    // add followed user
    <% if Following.count == 1 %>
      // remove no_followings_found message
      $('.js-followed-users-container').empty();
    <% end %>
    $followed_user = $("<%= j render 'layouts/followed_user', following: FollowingDecorator.decorate(@following) %>");
    $followed_user.css('display', 'none');
    $('.js-followed-users-container').append($followed_user);
    $followed_user.fadeIn('slow');
  <% else %>
      $('<%= "#js-following-#{@following.id}" %>').fadeOut('slow', function(){
        $(this).remove();
        // remove followed user
        <% if Following.count == 0 %>
          // refresh followed users container
          $followed_users = $("<%= j render 'layouts/followed_users', followings: [] %>");
          $('.js-followed-users-container').html($followed_users);
        <% end %>
      });
  <% end %>
});